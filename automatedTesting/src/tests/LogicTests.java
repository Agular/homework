package tests;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Assert;
import org.junit.Test;
import openweathermap.service.WeatherAPI;
import openweathermap.service.WeatherClient;
import openweathermap.service.WeatherDAO;
import openweathermap.service.WeatherHelper;
import openweathermap.weather.Coordinates;
import openweathermap.weather.ForecastMaxMinTemperatures;
import openweathermap.weather.MaxMinTemperatures;
import openweathermap.weather.Temperature;

import java.io.IOException;
import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;

public class LogicTests {
    private final int CITY_ID = 588409;
    private final String API_KEY = "fde9c3d325025e6e3e3fc555c0f71b9c";

    @Test
    public void is5DayForecastMaxMinTemperaturesCorrect() throws IOException {
        WeatherHelper helper = new WeatherHelper();
        ObjectMapper mapper = new ObjectMapper();
        JsonNode forecastNode = mapper.readTree("{\"cod\":\"200\",\"message\":0.0028,\"cnt\":40,\"list\":[{\"dt\":1508684400,\"main\":{\"temp\":275.7,\"temp_min\":275.482,\"temp_max\":275.7,\"pressure\":1029.44,\"sea_level\":1033.14,\"grnd_level\":1029.44,\"humidity\":100,\"temp_kf\":0.22},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03n\"}],\"clouds\":{\"all\":32},\"wind\":{\"speed\":3.67,\"deg\":0.00311279},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-22 15:00:00\"},{\"dt\":1508695200,\"main\":{\"temp\":275.28,\"temp_min\":275.117,\"temp_max\":275.28,\"pressure\":1029.7,\"sea_level\":1033.44,\"grnd_level\":1029.7,\"humidity\":100,\"temp_kf\":0.16},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":2.91,\"deg\":21.5024},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-22 18:00:00\"},{\"dt\":1508706000,\"main\":{\"temp\":275.4,\"temp_min\":275.289,\"temp_max\":275.4,\"pressure\":1030.19,\"sea_level\":1033.78,\"grnd_level\":1030.19,\"humidity\":100,\"temp_kf\":0.11},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":2.66,\"deg\":54.5003},\"rain\":{\"3h\":0.025},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-22 21:00:00\"},{\"dt\":1508716800,\"main\":{\"temp\":275.07,\"temp_min\":275.02,\"temp_max\":275.07,\"pressure\":1030.78,\"sea_level\":1034.47,\"grnd_level\":1030.78,\"humidity\":100,\"temp_kf\":0.05},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":68},\"wind\":{\"speed\":3.21,\"deg\":75.5033},\"rain\":{\"3h\":0.17},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-23 00:00:00\"},{\"dt\":1508727600,\"main\":{\"temp\":275.06,\"temp_min\":275.06,\"temp_max\":275.06,\"pressure\":1031.76,\"sea_level\":1035.42,\"grnd_level\":1031.76,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":64},\"wind\":{\"speed\":5.42,\"deg\":94.0006},\"rain\":{\"3h\":0.335},\"snow\":{\"3h\":0.01375},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-23 03:00:00\"},{\"dt\":1508738400,\"main\":{\"temp\":273.715,\"temp_min\":273.715,\"temp_max\":273.715,\"pressure\":1033.62,\"sea_level\":1037.14,\"grnd_level\":1033.62,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":32},\"wind\":{\"speed\":4.31,\"deg\":100.005},\"rain\":{\"3h\":0.145},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-23 06:00:00\"},{\"dt\":1508749200,\"main\":{\"temp\":275.917,\"temp_min\":275.917,\"temp_max\":275.917,\"pressure\":1035.36,\"sea_level\":1038.93,\"grnd_level\":1035.36,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":24},\"wind\":{\"speed\":3.68,\"deg\":104.503},\"rain\":{\"3h\":0.035},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-23 09:00:00\"},{\"dt\":1508760000,\"main\":{\"temp\":277.379,\"temp_min\":277.379,\"temp_max\":277.379,\"pressure\":1036.42,\"sea_level\":1039.98,\"grnd_level\":1036.42,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02d\"}],\"clouds\":{\"all\":20},\"wind\":{\"speed\":3.46,\"deg\":96.005},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-23 12:00:00\"},{\"dt\":1508770800,\"main\":{\"temp\":275.758,\"temp_min\":275.758,\"temp_max\":275.758,\"pressure\":1037.33,\"sea_level\":1041.02,\"grnd_level\":1037.33,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03n\"}],\"clouds\":{\"all\":32},\"wind\":{\"speed\":3.2,\"deg\":72.5},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-23 15:00:00\"},{\"dt\":1508781600,\"main\":{\"temp\":273.585,\"temp_min\":273.585,\"temp_max\":273.585,\"pressure\":1038.62,\"sea_level\":1042.36,\"grnd_level\":1038.62,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":56},\"wind\":{\"speed\":2.32,\"deg\":78.5009},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-23 18:00:00\"},{\"dt\":1508792400,\"main\":{\"temp\":273.555,\"temp_min\":273.555,\"temp_max\":273.555,\"pressure\":1039.62,\"sea_level\":1043.42,\"grnd_level\":1039.62,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":68},\"wind\":{\"speed\":0.72,\"deg\":94.0002},\"rain\":{\"3h\":0.015},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-23 21:00:00\"},{\"dt\":1508803200,\"main\":{\"temp\":273.849,\"temp_min\":273.849,\"temp_max\":273.849,\"pressure\":1040.39,\"sea_level\":1044.1,\"grnd_level\":1040.39,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":68},\"wind\":{\"speed\":0.52,\"deg\":315.002},\"rain\":{\"3h\":0.02},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-24 00:00:00\"},{\"dt\":1508814000,\"main\":{\"temp\":274.297,\"temp_min\":274.297,\"temp_max\":274.297,\"pressure\":1041.04,\"sea_level\":1044.76,\"grnd_level\":1041.04,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":0.67,\"deg\":290.003},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-24 03:00:00\"},{\"dt\":1508824800,\"main\":{\"temp\":275.139,\"temp_min\":275.139,\"temp_max\":275.139,\"pressure\":1041.86,\"sea_level\":1045.59,\"grnd_level\":1041.86,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":80},\"wind\":{\"speed\":0.76,\"deg\":254.501},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-24 06:00:00\"},{\"dt\":1508835600,\"main\":{\"temp\":277.091,\"temp_min\":277.091,\"temp_max\":277.091,\"pressure\":1042.71,\"sea_level\":1046.32,\"grnd_level\":1042.71,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":1.68,\"deg\":233},\"rain\":{\"3h\":0.015},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-24 09:00:00\"},{\"dt\":1508846400,\"main\":{\"temp\":277.797,\"temp_min\":277.797,\"temp_max\":277.797,\"pressure\":1043.04,\"sea_level\":1046.73,\"grnd_level\":1043.04,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":56},\"wind\":{\"speed\":2.22,\"deg\":225.001},\"rain\":{\"3h\":0.005},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-24 12:00:00\"},{\"dt\":1508857200,\"main\":{\"temp\":275.77,\"temp_min\":275.77,\"temp_max\":275.77,\"pressure\":1043.13,\"sea_level\":1046.81,\"grnd_level\":1043.13,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":36},\"wind\":{\"speed\":2.31,\"deg\":199.001},\"rain\":{\"3h\":0.02},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-24 15:00:00\"},{\"dt\":1508868000,\"main\":{\"temp\":272.933,\"temp_min\":272.933,\"temp_max\":272.933,\"pressure\":1043.18,\"sea_level\":1046.91,\"grnd_level\":1043.18,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":2.86,\"deg\":194.506},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-24 18:00:00\"},{\"dt\":1508878800,\"main\":{\"temp\":271.723,\"temp_min\":271.723,\"temp_max\":271.723,\"pressure\":1043.03,\"sea_level\":1046.75,\"grnd_level\":1043.03,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":3.92,\"deg\":175.501},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-24 21:00:00\"},{\"dt\":1508889600,\"main\":{\"temp\":271.601,\"temp_min\":271.601,\"temp_max\":271.601,\"pressure\":1042.43,\"sea_level\":1046.12,\"grnd_level\":1042.43,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.56,\"deg\":168.003},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-25 00:00:00\"},{\"dt\":1508900400,\"main\":{\"temp\":271.806,\"temp_min\":271.806,\"temp_max\":271.806,\"pressure\":1041.15,\"sea_level\":1044.74,\"grnd_level\":1041.15,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":6.37,\"deg\":171.002},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-25 03:00:00\"},{\"dt\":1508911200,\"main\":{\"temp\":271.611,\"temp_min\":271.611,\"temp_max\":271.611,\"pressure\":1039.26,\"sea_level\":1042.86,\"grnd_level\":1039.26,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":7.62,\"deg\":166.503},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-25 06:00:00\"},{\"dt\":1508922000,\"main\":{\"temp\":273.107,\"temp_min\":273.107,\"temp_max\":273.107,\"pressure\":1036.95,\"sea_level\":1040.57,\"grnd_level\":1036.95,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":8.87,\"deg\":163.501},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-25 09:00:00\"},{\"dt\":1508932800,\"main\":{\"temp\":274.215,\"temp_min\":274.215,\"temp_max\":274.215,\"pressure\":1034.3,\"sea_level\":1037.88,\"grnd_level\":1034.3,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":9.87,\"deg\":166.502},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-25 12:00:00\"},{\"dt\":1508943600,\"main\":{\"temp\":273.814,\"temp_min\":273.814,\"temp_max\":273.814,\"pressure\":1031.5,\"sea_level\":1035.07,\"grnd_level\":1031.5,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":56},\"wind\":{\"speed\":10.27,\"deg\":165.504},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-25 15:00:00\"},{\"dt\":1508954400,\"main\":{\"temp\":273.745,\"temp_min\":273.745,\"temp_max\":273.745,\"pressure\":1028.5,\"sea_level\":1032.07,\"grnd_level\":1028.5,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":64},\"wind\":{\"speed\":11.04,\"deg\":163.006},\"rain\":{},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-25 18:00:00\"},{\"dt\":1508965200,\"main\":{\"temp\":273.464,\"temp_min\":273.464,\"temp_max\":273.464,\"pressure\":1025.52,\"sea_level\":1029.03,\"grnd_level\":1025.52,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":64},\"wind\":{\"speed\":11.65,\"deg\":162.506},\"rain\":{\"3h\":0.01},\"snow\":{\"3h\":0.22125},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-25 21:00:00\"},{\"dt\":1508976000,\"main\":{\"temp\":273.694,\"temp_min\":273.694,\"temp_max\":273.694,\"pressure\":1022.93,\"sea_level\":1026.41,\"grnd_level\":1022.93,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":11.14,\"deg\":160.501},\"rain\":{\"3h\":0.01},\"snow\":{\"3h\":0.695},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-26 00:00:00\"},{\"dt\":1508986800,\"main\":{\"temp\":274.113,\"temp_min\":274.113,\"temp_max\":274.113,\"pressure\":1019.77,\"sea_level\":1023.3,\"grnd_level\":1019.77,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":10.92,\"deg\":157},\"rain\":{\"3h\":0.0099999999999999},\"snow\":{\"3h\":0.41},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-26 03:00:00\"},{\"dt\":1508997600,\"main\":{\"temp\":274.27,\"temp_min\":274.27,\"temp_max\":274.27,\"pressure\":1017.37,\"sea_level\":1020.87,\"grnd_level\":1017.37,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":10.66,\"deg\":153.006},\"rain\":{\"3h\":0.1},\"snow\":{\"3h\":1.93},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-26 06:00:00\"},{\"dt\":1509008400,\"main\":{\"temp\":275.522,\"temp_min\":275.522,\"temp_max\":275.522,\"pressure\":1015.48,\"sea_level\":1018.98,\"grnd_level\":1015.48,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":9.94,\"deg\":153.503},\"rain\":{\"3h\":0.41},\"snow\":{\"3h\":0.055},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-26 09:00:00\"},{\"dt\":1509019200,\"main\":{\"temp\":276.658,\"temp_min\":276.658,\"temp_max\":276.658,\"pressure\":1013.66,\"sea_level\":1017.26,\"grnd_level\":1013.66,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":8.31,\"deg\":153.501},\"rain\":{\"3h\":0.58},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-26 12:00:00\"},{\"dt\":1509030000,\"main\":{\"temp\":277.082,\"temp_min\":277.082,\"temp_max\":277.082,\"pressure\":1012.26,\"sea_level\":1015.85,\"grnd_level\":1012.26,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":88},\"wind\":{\"speed\":6.11,\"deg\":153.001},\"rain\":{\"3h\":0.4},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-26 15:00:00\"},{\"dt\":1509040800,\"main\":{\"temp\":277.344,\"temp_min\":277.344,\"temp_max\":277.344,\"pressure\":1011.13,\"sea_level\":1014.72,\"grnd_level\":1011.13,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":4.31,\"deg\":148.003},\"rain\":{\"3h\":0.18},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-26 18:00:00\"},{\"dt\":1509051600,\"main\":{\"temp\":277.23,\"temp_min\":277.23,\"temp_max\":277.23,\"pressure\":1009.97,\"sea_level\":1013.48,\"grnd_level\":1009.97,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":80},\"wind\":{\"speed\":4.3,\"deg\":123.504},\"rain\":{\"3h\":0.28},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-26 21:00:00\"},{\"dt\":1509062400,\"main\":{\"temp\":276.795,\"temp_min\":276.795,\"temp_max\":276.795,\"pressure\":1009.28,\"sea_level\":1012.77,\"grnd_level\":1009.28,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":92},\"wind\":{\"speed\":5.57,\"deg\":101.004},\"rain\":{\"3h\":0.55},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-27 00:00:00\"},{\"dt\":1509073200,\"main\":{\"temp\":275.978,\"temp_min\":275.978,\"temp_max\":275.978,\"pressure\":1009.39,\"sea_level\":1012.87,\"grnd_level\":1009.39,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":80},\"wind\":{\"speed\":6.46,\"deg\":85},\"rain\":{\"3h\":0.46},\"snow\":{},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2017-10-27 03:00:00\"},{\"dt\":1509084000,\"main\":{\"temp\":275.077,\"temp_min\":275.077,\"temp_max\":275.077,\"pressure\":1010.46,\"sea_level\":1013.91,\"grnd_level\":1010.46,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":76},\"wind\":{\"speed\":6.37,\"deg\":82.0015},\"rain\":{\"3h\":0.04},\"snow\":{\"3h\":0.015},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-27 06:00:00\"},{\"dt\":1509094800,\"main\":{\"temp\":275.289,\"temp_min\":275.289,\"temp_max\":275.289,\"pressure\":1011.59,\"sea_level\":1015.13,\"grnd_level\":1011.59,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":56},\"wind\":{\"speed\":5.26,\"deg\":79.0032},\"rain\":{\"3h\":0.01},\"snow\":{\"3h\":0.01},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-27 09:00:00\"},{\"dt\":1509105600,\"main\":{\"temp\":276.102,\"temp_min\":276.102,\"temp_max\":276.102,\"pressure\":1012.7,\"sea_level\":1016.25,\"grnd_level\":1012.7,\"humidity\":100,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":32},\"wind\":{\"speed\":4.85,\"deg\":69.0013},\"rain\":{\"3h\":0.06},\"snow\":{},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2017-10-27 12:00:00\"}],\"city\":{\"id\":588409,\"name\":\"Tallinn\",\"coord\":{\"lat\":59.437,\"lon\":24.7535},\"country\":\"EE\"}}");
        List<MaxMinTemperatures> temperaturesList = new ArrayList<>();
        MaxMinTemperatures temp0 = new MaxMinTemperatures(LocalDate.of(2017, 10, 22), new Temperature(2.55), new Temperature(2.13));
        MaxMinTemperatures temp1 = new MaxMinTemperatures(LocalDate.of(2017, 10, 23), new Temperature(4.23), new Temperature(0.41));
        MaxMinTemperatures temp2 = new MaxMinTemperatures(LocalDate.of(2017, 10, 24), new Temperature(4.65), new Temperature(-1.43));
        MaxMinTemperatures temp3 = new MaxMinTemperatures(LocalDate.of(2017, 10, 25), new Temperature(1.06), new Temperature(-1.55));
        MaxMinTemperatures temp4 = new MaxMinTemperatures(LocalDate.of(2017, 10, 26), new Temperature(4.19), new Temperature(0.54));
        MaxMinTemperatures temp5 = new MaxMinTemperatures(LocalDate.of(2017, 10, 27), new Temperature(3.65), new Temperature(1.93));
        temperaturesList.add(temp0);
        temperaturesList.add(temp1);
        temperaturesList.add(temp2);
        temperaturesList.add(temp3);
        temperaturesList.add(temp4);
        temperaturesList.add(temp5);

        Assert.assertEquals(new ForecastMaxMinTemperatures(temperaturesList), helper.getMaxMinTemperaturesFromNode(forecastNode));
    }

    @Test
    public void isCoordinatesCorrect() throws IOException {
        WeatherDAO weatherDAO = new WeatherDAO(new WeatherAPI(), new WeatherHelper());
        WeatherClient weatherClient = new WeatherClient(API_KEY, weatherDAO);
        Coordinates expectedCoordinates = new Coordinates(24.75, 59.44);
        Coordinates actualCoordinates = weatherClient.getCoordinatesByCityId(CITY_ID);
        Assert.assertEquals(expectedCoordinates, actualCoordinates);
    }

    @Test
    public void convertKelvinStringToCelsiusTemperatureIsCorrect() throws IOException {
        WeatherHelper helper = new WeatherHelper();
        JsonNode apiResponse = new ObjectMapper().readTree(
                "{\"main\":{\"temp\":283.15}}");
        Assert.assertEquals(new Temperature(10.0), helper.convertKelvinStringToCelsiusTemperature(apiResponse));
    }

    @Test
    public void convertOneDayMaxMinTemperaturesToCelsiusIsCorrect() {
        WeatherHelper helper = new WeatherHelper();
        MaxMinTemperatures temperatures = new MaxMinTemperatures(LocalDate.now(), new Temperature(290.15), new Temperature(280.15));
        helper.convertOneDayMaxMinTemperaturesToCelsius(temperatures);
        Assert.assertEquals(new MaxMinTemperatures(LocalDate.now(), new Temperature(17.0), new Temperature(7.0)),temperatures );
    }

    @Test
    public void isRoundValueCorrect() {
        WeatherHelper helper = new WeatherHelper();
        Assert.assertEquals(109.60, helper.roundValue(109.598), 0.0);
    }
}
